<!DOCTYPE html>
<html lang="en" class="scroll-smooth" xmlns:x-transition="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="NeoWareWiki/logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAPI | NeoWare Wiki</title>
    <meta name="description" content="NeoWare Script Wiki">
    <link rel="stylesheet" href="/NeoWareWiki/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Display:wght@600;700&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js" integrity="sha512-HcBl0GSJvt4Qecm4srHapirUx0HJDi2zYXm6KUKNNUGdTIN9cBwakVZHWmRVj4MKgy1AChqhWGYcMDbRKgO0zg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body x-data="{ docs: false, mobile: false }" class="relative">
<header @click.outside="mobile = false" class="sticky top-0 z-50 bg-white shadow-md shadow-slate-900/5 transition duration-500">
    <div class="mx-auto max-w-7xl flex flex-wrap items-center space-x-8 justify-between px-6 lg:px-8 py-4">
        <div class="flex items-center">
            <button @click="docs = ! docs" type="button" class="relative lg:hidden mr-3" aria-label="Open navigation">
                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" class="h-6 w-6 stroke-slate-500">
                    <path d="M4 7h16M4 12h16M4 17h16"></path>
                </svg>
            </button>
            <a aria-label="Home page" href="/NeoWareWiki/">
                <p class="h-7 hidden sm:block">NeoWare Wiki</p>
            </a>
            <nav class="hidden lg:flex lg:space-x-8 lg:ml-12 xl:ml-16">
                <a class='text-sm hover:text-sky-500 py-2.5 text-slate-900 font-display font-semibold' href='https://krytickyt.github.io/NeoWare/'>Главная</a>
                <a class='text-sm hover:text-sky-500 py-2.5 text-slate-900 font-display font-semibold' href='https://discord.com/invite/2rxyndXyUB'>Discord</a>
            </nav>
        </div>
    </div>
</header>
<script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.5/awesomplete.min.js" integrity="sha512-HcBl0GSJvt4Qecm4srHapirUx0HJDi2zYXm6KUKNNUGdTIN9cBwakVZHWmRVj4MKgy1AChqhWGYcMDbRKgO0zg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<div class="relative mx-auto flex max-w-7xl justify-center px-2 lg:px-8">
    <div class="hidden lg:relative lg:block lg:flex-none">
        <div class="sticky top-[4.5rem] -ml-0.5 h-[calc(100vh-4.5rem)] w-64 overflow-y-auto overflow-x-hidden pt-16 pl-0.5 pr-8 xl:w-72 xl:pr-16">
            <nav class="text-sm">
                <ul class="space-y-9">
                    <li>
                        <h2 class="font-display font-semibold text-slate-900">API</h2>
                        <ul class="mt-4 space-y-4 border-slate-200">
                            <li class="relative">
                                <a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block" href="/NeoWareWiki/">Общее</a>
                            </li>
                            <li class="relative">
                                <a class='block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block' href='/NeoWareWiki/botapi.html'>Боты</a>
                            </li>
                            <li class="relative">
                                <a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block" href="/NeoWareWiki/commands.html">Команды</a>
                            </li>
                            <li class="relative">
                                <a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block" href="/NeoWareWiki/parameters.html">Параметры ботов</a>
                            </li>
                            <li class="relative">
                                <a class="block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-sky-500 before:bg-sky-500" href="/NeoWareWiki/webapi.html">WebAPI</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="font-display font-semibold text-slate-900">Code</h2>
                        <ul class="mt-4 space-y-4 border-slate-200">
                            <li class="relative">
                                <a class='block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block' href='/NeoWareWiki/events.html'>Ивенты</a>
                            </li>
                            <li class="relative">
                                <a class='block w-full pl-3.5 before:pointer-events-none before:absolute before:left-0.5 before:top-1/2 before:h-0.5 before:w-1.5 before:-translate-y-1/2 text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-900 hover:before:block' href='/NeoWareWiki/examples.html'>Примеры</a>
                            </li>
                        </ul>
                    </li>
                </ul>
                </li>
                </ul>
            </nav>
        </div>
    </div>
    <div class="min-w-0 max-w-2xl flex-auto px-4 pt-16 lg:max-w-none lg:pl-8 lg:pr-0 xl:px-16">
        <article>
            <div class="prose prose-slate max-w-none prose-headings:scroll-mt-28 prose-headings:font-display prose-headings:font-semibold lg:prose-headings:scroll-mt-[8.5rem] prose-lead:text-slate-500 prose-a:font-semibold prose-a:no-underline prose-pre:rounded-xl prose-pre:bg-slate-900 prose-pre:shadow-lg">
                <h2 id="webapi">WebAPI</h2>
                <p>NeoWare способен решать вебкапчи используя Python и другие языки, все благодаря WebAPI</p>
                <p>В чем смысл? В клиенте уже есть вариант прохождения капч, но там невозможно что либо изменить/дополнить</p>
                <p>Используя WebAPI, можно сделать почти автоматическое решение вебкапч, все зависит от ваших навыков</p>
                <h3 id="solver">Солвер, Python часть</h3>
<pre class="hljs" style="color: rgb(169, 183, 198); background: rgb(40, 43, 46); display: block; overflow-x: auto; padding: 0.5em;"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">from</span> http.server <span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> BaseHTTPRequestHandler, HTTPServer
<span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> logging
<span class="hljs-keyword" style="color: rgb(204, 120, 50);">from</span> urllib.parse <span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> urlparse, parse_qs
<span class="hljs-keyword" style="color: rgb(204, 120, 50);">from</span> seleniumbase <span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> Driver
<span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> time
<span class="hljs-keyword" style="color: rgb(204, 120, 50);">import</span> threading

<span class="hljs-class"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">class</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">S</span><span class="hljs-params">(BaseHTTPRequestHandler)</span>:</span>

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">def</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">_set_response</span><span class="hljs-params">(self)</span>:</span>
        self.send_response(<span class="hljs-number" style="color: rgb(104, 151, 187);">200</span>)
        self.send_header(<span class="hljs-string" style="color: rgb(106, 135, 89);">'Content-type'</span>, <span class="hljs-string" style="color: rgb(106, 135, 89);">'text/html'</span>)
        self.end_headers()

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">def</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">do_GET</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword" style="color: rgb(204, 120, 50);">if</span> <span class="hljs-string" style="color: rgb(106, 135, 89);">"work.php"</span> <span class="hljs-keyword" style="color: rgb(204, 120, 50);">in</span> str(self.path):
            parsed_url = urlparse(self.path)
            query_params = parse_qs(parsed_url.query)
            
            url = query_params.get(<span class="hljs-string" style="color: rgb(106, 135, 89);">'url'</span>, [<span class="hljs-keyword" style="color: rgb(204, 120, 50);">None</span>])[<span class="hljs-number" style="color: rgb(104, 151, 187);">0</span>]
            proxy = query_params.get(<span class="hljs-string" style="color: rgb(106, 135, 89);">'proxy'</span>, [<span class="hljs-keyword" style="color: rgb(204, 120, 50);">None</span>])[<span class="hljs-number" style="color: rgb(104, 151, 187);">0</span>]
            proxyType = query_params.get(<span class="hljs-string" style="color: rgb(106, 135, 89);">'type'</span>, [<span class="hljs-keyword" style="color: rgb(204, 120, 50);">None</span>])[<span class="hljs-number" style="color: rgb(104, 151, 187);">0</span>]
            bot = query_params.get(<span class="hljs-string" style="color: rgb(106, 135, 89);">'botnickname'</span>, [<span class="hljs-keyword" style="color: rgb(204, 120, 50);">None</span>])[<span class="hljs-number" style="color: rgb(104, 151, 187);">0</span>]
            print(url)
            print(proxy)
            print(proxyType)
            print(bot)

            threading.Thread(target=self.start_driver, args=(url, proxyType, proxy)).start()

            self._set_response()
            self.wfile.write(f<span class="hljs-string" style="color: rgb(106, 135, 89);">"GET request for {self.path}, client parameter:"</span>.encode(<span class="hljs-string" style="color: rgb(106, 135, 89);">'utf-8'</span>))

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">def</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">start_driver</span><span class="hljs-params">(self, url, proxy_type, proxy)</span>:</span>
        driver = Driver(uc=<span class="hljs-keyword" style="color: rgb(204, 120, 50);">True</span>, proxy=f<span class="hljs-string" style="color: rgb(106, 135, 89);">"{proxy_type}://{proxy}"</span>)
        driver.get(url)

    <span class="hljs-function"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">def</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">do_POST</span><span class="hljs-params">(self)</span>:</span>
        self._set_response()
        self.wfile.write(f<span class="hljs-string" style="color: rgb(106, 135, 89);">"POST request for {self.path}"</span>.encode(<span class="hljs-string" style="color: rgb(106, 135, 89);">'utf-8'</span>))

<span class="hljs-function"><span class="hljs-keyword" style="color: rgb(204, 120, 50);">def</span> <span class="hljs-title" style="color: rgb(255, 198, 109);">run</span><span class="hljs-params">(server_class=HTTPServer, handler_class=S, port=<span class="hljs-number" style="color: rgb(104, 151, 187);">80</span>)</span>:</span>
    logging.basicConfig(level=logging.INFO)
    server_address = (<span class="hljs-string" style="color: rgb(106, 135, 89);">''</span>, port)
    httpd = server_class(server_address, handler_class)
    logging.info(<span class="hljs-string" style="color: rgb(106, 135, 89);">'Starting httpd...\n'</span>)
    <span class="hljs-keyword" style="color: rgb(204, 120, 50);">try</span>:
        httpd.serve_forever()
    <span class="hljs-keyword" style="color: rgb(204, 120, 50);">except</span> KeyboardInterrupt:
        <span class="hljs-keyword" style="color: rgb(204, 120, 50);">pass</span>
    httpd.server_close()
    logging.info(<span class="hljs-string" style="color: rgb(106, 135, 89);">'Stopping httpd...\n'</span>)

<span class="hljs-keyword" style="color: rgb(204, 120, 50);">if</span> __name__ == <span class="hljs-string" style="color: rgb(106, 135, 89);">'__main__'</span>:
    run(port=<span class="hljs-number" style="color: rgb(104, 151, 187);">8080</span>)</pre>
                <p>В этом примере кода локальный http сервер принимает GET запросы от клиента с параметрами</p>
                <p>Сам запрос выглядит так: http://127.0.0.1:8080/work.php?client=neoware&url=https://captcha.reallyworld.me/authorize/&proxy=0.0.0.0&type=socks5&botnickname=NeoWare_24335</p>
                <p>url - Ссылка на капчу</p>
                <p>proxy - Прокси бота</p>
                <p>type - Тип прокси от бота, socks4/socks5/http</p>
                <p>botnickname - Ник бота</p>
                <p>Вся дичь с веб страницей происходит в def start_driver(), для каждой страницы там отдельный поток</p>
                <h3 id="client">Клиент</h3>
                <p>Заходим в кликгуи, находим модуль WebSolver и в нем нужно выбрать "SolverMode: WebAPI" И ТОЛЬКО ПОТОМ ВКЛЮЧАЕМ МОДУЛЬ! Все остальные настройки можно проводить после. Из важного, WebHost - адрес сайта, если он локальный не меняем, либо ставим 127.0.0.1:8080. Если нужно изменить порт, то меняйте его и в WebHost, и в Python солвере. Если включить режим без прокси, то на месте proxy в параметрах запроса будет 0.0.0.0</p>
                <p>Возможные баги:</p>
                <p>Ошибка с библиотеками - Ставим все, что просит</p>
                <p>Не грузит страницу - При использовании socks4 и других медленных прокси мы автоматически идем НАХУЙ</p>
                <p>Не открывается страница - Проверяем, солвер должен написать в консоль "Starting httpd..." В клиенте должен быть выбран WebAPI в SolverMode у модуля WebSolver, и сам модуль должен быть включен!</p>
                <p>При нахождении других багов пишите в тикеты :)</p>
                <h3 id="default">Параметры по умолчанию</h3>
                <img src="https://raw.githubusercontent.com/KrytickYT/NeoWareWiki/main/image/webapi.png" style="padding:1px;border:thin solid black;">
                <p></p>
            </div>
        </article>
    </div>
    <footer>
        <div class="mx-auto max-w-7xl px-6 pb-8 pt-16 lg:px-8 lg:pt-28"></div>
    </footer>
</div>
</body>
</html>
